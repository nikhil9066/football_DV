<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Top 10 Home Teams Winning Most Matches</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div id="visualization"></div>
    <div>
        <input type="button" value="AFC Asian Cup" onclick="updateData('AFC Asian Cup')">
        <input type="button" value="African Cup of Nations" onclick="updateData('African Cup of Nations')">
        <input type="button" value="Confederations Cup" onclick="updateData('Confederations Cup')">
        <input type="button" value="Copa América" onclick="updateData('Copa América')">
        <input type="button" value="FIFA World Cup" onclick="updateData('FIFA World Cup')">
        <input type="button" value="King's Cup" onclick="updateData('King\'s Cup')">
        <input type="button" value="UEFA Nations League" onclick="updateData('UEFA Nations League')">
        <input type="button" value="UEFA Euro" onclick="updateData('UEFA Euro')">
    </div>
    <script>
        // Fetch the data from the JSON file
        d3.json("data/result.json").then(function(results) {
            const width = 500;
            const height = 200;
            const margin = { top: 20, right: 20, bottom: 30, left: 40 };

            let selectedTournament = "AFC Asian Cup"; // Default tournament

            function updateData(tournament) {
                selectedTournament = tournament;
                updateVisualization();
            }

            function updateVisualization() {
                const filteredResults = results.filter(d => d.tournament === selectedTournament);

                const winningHomeTeams = d3.rollups(
                    filteredResults,
                    v => d3.sum(v, d => d.home_score > d.away_score),
                    d => d.home_team
                );

                const svg = d3.select("#visualization").html("");

                const newSvg = svg.append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

                const xScale = d3.scaleBand()
                    .domain(d3.range(10))
                    .range([0, width])
                    .padding(0.1);

                const yScale = d3.scaleLinear()
                    .domain([0, d3.max(winningHomeTeams, d => d[1])])
                    .range([height, 0]);

                const colorScale = d3.scaleOrdinal(d3.schemeCategory10);

                newSvg.selectAll(".bar")
                    .data(winningHomeTeams.slice(0, 10))
                    .enter().append("rect")
                    .attr("class", "bar")
                    .attr("x", (d, i) => xScale(i))
                    .attr("width", xScale.bandwidth())
                    .attr("y", height) // Start from the bottom for a smooth transition
                    .attr("height", 0)  // Start with zero height
                    .attr("fill", (d, i) => colorScale(i))
                    .transition() // Add transition
                    .duration(1000) // Set duration of transition
                    .attr("y", d => yScale(d[1]))
                    .attr("height", d => height - yScale(d[1]));

                newSvg.append("g")
                    .attr("transform", "translate(0," + height + ")")
                    .call(d3.axisBottom(xScale));

                newSvg.append("g")
                    .call(d3.axisLeft(yScale));

                newSvg.append("text")
                    .attr("x", width / 2)
                    .attr("y", height + margin.bottom)
                    .attr("text-anchor", "middle")
                    .text("Top 10 Teams");

                newSvg.append("text")
                    .attr("transform", "rotate(-90)")
                    .attr("y", -margin.left)
                    .attr("x", -height / 2)
                    .attr("dy", "1em")
                    .attr("text-anchor", "middle")
                    .text("Matches Won");

                newSvg.append("text")
                    .attr("x", width / 2)
                    .attr("y", -margin.top / 2)
                    .attr("text-anchor", "middle")
                    .style("font-size", "16px")
                    .text(selectedTournament);
            }

            // Initial visualization
            updateVisualization();
        });
    </script>
</body>
</html>
